<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thanh toán - WebBanHoa</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <div class="hotline">
                        <i class="fas fa-phone"></i>
                        <span>Hotline: 1900 1234</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="top-links">
                        <a href="auth/login.html">Đăng nhập</a>
                        <a href="auth/register.html">Đăng ký</a>
                        <a href="cart.html">
                            <i class="fas fa-shopping-cart"></i>
                            Giỏ hàng
                        </a>
                        <a href="checkout.html">
                            <i class="fas fa-credit-card"></i>
                            Thanh toán
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Header -->
    <header class="main-header">
        <div class="container">
            <div class="row align-items-center">
                <!-- Social Icons -->
                <div class="col-md-3">
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                        <a href="#"><i class="fab fa-tiktok"></i></a>
                    </div>
                </div>
                
                <!-- Logo -->
                <div class="col-md-6 text-center">
                    <div class="logo">
                        <a href="index.html">
                            <img src="assets/logo.png" alt="WebBanHoa Logo" class="img-fluid">
                        </a>
                    </div>
                </div>
                
                <!-- Search & Cart -->
                <div class="col-md-3">
                    <div class="search-cart">
                        <div class="search-box">
                            <input type="text" placeholder="Tìm kiếm sản phẩm..." id="searchInput">
                            <button type="button" class="search-btn">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <div class="cart-icon">
                            <a href="cart.html">
                                <i class="fas fa-shopping-bag"></i>
                                <span class="cart-badge" id="cartBadge">0</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Checkout Content -->
    <section class="checkout-section">
        <div class="container">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Trang chủ</a></li>
                    <li class="breadcrumb-item"><a href="cart.html">Giỏ hàng</a></li>
                    <li class="breadcrumb-item active">Thanh toán</li>
                </ol>
            </nav>

            <h1 class="page-title">Thanh toán</h1>

            <div class="row">
                <div class="col-lg-8">
                    <!-- Checkout Form -->
                    <form id="checkoutForm">
                        <!-- Billing Information -->
                        <div class="checkout-section-card">
                            <h4><i class="fas fa-user"></i> Thông tin giao hàng</h4>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label for="firstName" class="form-label">Họ *</label>
                                        <input type="text" class="form-control" id="firstName" name="firstName" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label for="lastName" class="form-label">Tên *</label>
                                        <input type="text" class="form-control" id="lastName" name="lastName" required>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label for="email" class="form-label">Email *</label>
                                        <input type="email" class="form-control" id="email" name="email" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label for="phone" class="form-label">Số điện thoại *</label>
                                        <input type="tel" class="form-control" id="phone" name="phone" required>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group mb-3">
                                <label for="address" class="form-label">Địa chỉ giao hàng *</label>
                                <textarea class="form-control" id="address" name="address" rows="3" required></textarea>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group mb-3">
                                        <label for="city" class="form-label">Thành phố *</label>
                                        <select class="form-select" id="city" name="city" required>
                                            <option value="">Chọn thành phố</option>
                                            <option value="hcm">TP. Hồ Chí Minh</option>
                                            <option value="hn">Hà Nội</option>
                                            <option value="dn">Đà Nẵng</option>
                                            <option value="hp">Hải Phòng</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group mb-3">
                                        <label for="district" class="form-label">Quận/Huyện *</label>
                                        <select class="form-select" id="district" name="district" required>
                                            <option value="">Chọn quận/huyện</option>
                                            <option value="q1">Quận 1</option>
                                            <option value="q2">Quận 2</option>
                                            <option value="q3">Quận 3</option>
                                            <option value="q7">Quận 7</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group mb-3">
                                        <label for="ward" class="form-label">Phường/Xã *</label>
                                        <input type="text" class="form-control" id="ward" name="ward" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Method -->
                        <div class="checkout-section-card">
                            <h4><i class="fas fa-credit-card"></i> Phương thức thanh toán</h4>
                            
                            <div class="payment-methods">
                                <div class="payment-option">
                                    <input type="radio" id="cod" name="paymentMethod" value="cod" checked>
                                    <label for="cod">
                                        <i class="fas fa-money-bill-wave"></i>
                                        <span>Thanh toán khi nhận hàng (COD)</span>
                                    </label>
                                </div>
                                
                                <div class="payment-option">
                                    <input type="radio" id="bank" name="paymentMethod" value="bank">
                                    <label for="bank">
                                        <i class="fas fa-university"></i>
                                        <span>Chuyển khoản ngân hàng</span>
                                    </label>
                                </div>
                                
                                <div class="payment-option">
                                    <input type="radio" id="momo" name="paymentMethod" value="momo">
                                    <label for="momo">
                                        <i class="fas fa-mobile-alt"></i>
                                        <span>Ví MoMo</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Order Notes -->
                        <div class="checkout-section-card">
                            <h4><i class="fas fa-sticky-note"></i> Ghi chú đơn hàng</h4>
                            <textarea class="form-control" id="notes" name="notes" rows="3" placeholder="Ghi chú thêm cho đơn hàng (không bắt buộc)"></textarea>
                        </div>
                    </form>
                </div>
                
                <div class="col-lg-4">
                    <!-- Order Summary -->
                    <div class="order-summary">
                        <h4>Đơn hàng của bạn</h4>
                        
                        <div class="order-items" id="orderItems">
                            <!-- Order items will be loaded here -->
                        </div>
                        
                        <hr>
                        
                        <div class="summary-row">
                            <span>Tạm tính:</span>
                            <span id="orderSubtotal">0 VNĐ</span>
                        </div>
                        
                        <div class="summary-row">
                            <span>Phí vận chuyển:</span>
                            <span id="orderShipping">30,000 VNĐ</span>
                        </div>
                        
                        <div class="summary-row total">
                            <span>Tổng cộng:</span>
                            <span id="orderTotal">30,000 VNĐ</span>
                        </div>
                        
                        <button type="button" class="btn btn-primary w-100 mt-3" id="placeOrderBtn">
                            Đặt hàng
                        </button>
                        
                        <a href="cart.html" class="btn btn-outline-secondary w-100 mt-2">
                            Quay lại giỏ hàng
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Floating Contact Bar -->
    <div class="floating-contact-bar">
        <div class="container">
            <div class="row">
                <div class="col-4">
                    <a href="tel:19001234" class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span>Gọi điện</span>
                    </a>
                </div>
                <div class="col-4">
                    <a href="https://zalo.me/19001234" class="contact-item">
                        <i class="fab fa-facebook-messenger"></i>
                        <span>Zalo</span>
                    </a>
                </div>
                <div class="col-4">
                    <a href="tel:19001235" class="contact-item">
                        <i class="fas fa-phone-alt"></i>
                        <span>Số khác</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <div class="footer-section">
                        <h4>WebBanHoa</h4>
                        <p>Cửa hàng hoa tươi uy tín với hơn 10 năm kinh nghiệm trong ngành.</p>
                        <div class="social-links">
                            <a href="#"><i class="fab fa-facebook-f"></i></a>
                            <a href="#"><i class="fab fa-instagram"></i></a>
                            <a href="#"><i class="fab fa-youtube"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="footer-section">
                        <h4>Liên kết</h4>
                        <ul>
                            <li><a href="#">Về chúng tôi</a></li>
                            <li><a href="#">Sản phẩm</a></li>
                            <li><a href="#">Khuyến mãi</a></li>
                            <li><a href="#">Liên hệ</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="footer-section">
                        <h4>Thông tin</h4>
                        <div class="contact-info">
                            <p><i class="fas fa-map-marker-alt"></i> 123 Đường ABC, Quận 1, TP.HCM</p>
                            <p><i class="fas fa-phone"></i> 1900 1234</p>
                            <p><i class="fas fa-envelope"></i> info@webbanhoa.com</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/scripts.js"></script>
    <script>
        // Checkout specific script
        document.addEventListener('DOMContentLoaded', function() {
            loadOrderItems();
            updateOrderSummary();
            
            // Load user info if logged in
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (currentUser) {
                document.getElementById('firstName').value = currentUser.firstName || '';
                document.getElementById('lastName').value = currentUser.lastName || '';
                document.getElementById('email').value = currentUser.email || '';
                document.getElementById('phone').value = currentUser.phone || '';
            }
        });
        
        function loadOrderItems() {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const orderItemsContainer = document.getElementById('orderItems');
            
            if (cart.length === 0) {
                orderItemsContainer.innerHTML = '<p class="text-muted">Giỏ hàng trống</p>';
                return;
            }
            
            orderItemsContainer.innerHTML = cart.map(item => `
                <div class="order-item">
                    <div class="row align-items-center">
                        <div class="col-3">
                            <img src="${item.image}" alt="${item.name}" class="img-fluid">
                        </div>
                        <div class="col-6">
                            <h6>${item.name}</h6>
                            <small class="text-muted">SL: ${item.quantity}</small>
                        </div>
                        <div class="col-3 text-end">
                            <strong>${formatPrice(item.price * item.quantity)}</strong>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function updateOrderSummary() {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const shipping = 30000;
            const total = subtotal + shipping;
            
            document.getElementById('orderSubtotal').textContent = formatPrice(subtotal);
            document.getElementById('orderTotal').textContent = formatPrice(total);
        }
        
        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN').format(price) + ' VNĐ';
        }
        
        // Place order
        document.getElementById('placeOrderBtn').addEventListener('click', function() {
            const form = document.getElementById('checkoutForm');
            const formData = new FormData(form);
            const orderData = Object.fromEntries(formData);
            
            // Validation
            if (!validateForm()) {
                return;
            }
            
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            if (cart.length === 0) {
                alert('Giỏ hàng trống!');
                return;
            }
            
            // Create order
            const order = {
                id: 'ORD' + Date.now(),
                orderDate: new Date().toISOString(),
                status: 'pending',
                items: cart,
                billing: orderData,
                subtotal: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                shipping: 30000,
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0) + 30000
            };
            
            // Save order to localStorage
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push(order);
            localStorage.setItem('orders', JSON.stringify(orders));
            
            // Clear cart
            localStorage.removeItem('cart');
            
            // Show success message
            alert('Đặt hàng thành công! Mã đơn hàng: ' + order.id);
            
            // Redirect to orders page or home
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (currentUser) {
                window.location.href = 'account/orders.html';
            } else {
                window.location.href = 'index.html';
            }
        });
        
        function validateForm() {
            const requiredFields = ['firstName', 'lastName', 'email', 'phone', 'address', 'city', 'district', 'ward'];
            let isValid = true;
            
            requiredFields.forEach(fieldName => {
                const field = document.getElementById(fieldName);
                if (!field.value.trim()) {
                    field.classList.add('is-invalid');
                    isValid = false;
                } else {
                    field.classList.remove('is-invalid');
                }
            });
            
            // Email validation
            const email = document.getElementById('email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email.value)) {
                email.classList.add('is-invalid');
                isValid = false;
            }
            
            return isValid;
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sản phẩm - Flower Shop</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/product.css">
    <link rel="stylesheet" th:href="@{/css/home.css}">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <a href="/home">
                <h1>FIAMA</h1>
            </a>
        </div>
        <nav class="nav-links">
            <a href="/home">Trang chủ</a>
            <a href="/product" class="active">Sản phẩm</a>
            <a href="#" th:if="${!isAdmin}">Liên hệ</a>
            <a href="/admin" th:if="${isAdmin}">Admin</a>
        </nav>
        <div class="utility-nav">
            <div th:if="${isLoggedIn}" class="user-dropdown">
                <a href="#" class="user-link">
                    <i class="fas fa-user"></i>
                    <span th:text="${userDisplayName}">User</span>
                </a>
                <div class="dropdown-menu">
                    <a href="/account">Tài khoản</a>
                    <a href="/logout">Đăng xuất</a>
                </div>
            </div>
            <a th:if="${!isLoggedIn}" href="/login" class="user-link">
                <i class="fas fa-user"></i>
                <span>Đăng nhập</span>
            </a>
            <a href="/cart" class="cart-icon-wrapper">
                <i class="fas fa-shopping-bag"></i>
                <span class="cart-count" id="cartCount">0</span>
            </a>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <div class="container">
            <a href="/home">Trang chủ</a>
            <span class="separator">›</span>
            <span class="current">Sản phẩm</span>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Header -->
        <section class="hero-section">
            <h1 class="page-title">Tất cả sản phẩm</h1>
            <p class="page-subtitle">Khám phá bộ sưu tập hoa tươi đẹp nhất của chúng tôi</p>
        </section>

    <!-- Products Grid -->
    <section class="products-section">
        <div class="products-grid" id="productsGrid">
            <!-- Dynamic Products from Model -->
            <div th:each="product : ${products}"
                 th:if="${product.stockQuantity > 0}"
                 class="product-card"
                 th:attr="data-product-id=${product.id}, data-product-name=${product.name}, data-product-price=${product.price}, data-product-image=${product.imageUrl}, data-product-stock=${product.stockQuantity}, data-product-description=${product.description != null ? product.description : ''}, data-product-rating=${product.getAverageRating()}, data-product-reviews=${product.getReviewCount()}">
                <div class="product-image-container" onclick="goToProductDetail(this.closest('.product-card'))">
                    <img th:src="${product.imageUrl}" th:alt="${product.name}" class="product-image">
                    <div class="product-overlay">
                        <button class="quick-view-btn" onclick="event.stopPropagation(); openQuickViewModal(this.closest('.product-card'))">Xem nhanh</button>
                    </div>
                </div>
                <div class="product-info">
                    <h3 class="product-name" th:text="${product.name}">Tên sản phẩm</h3>
                    <div class="product-price-container">
                        <span class="product-price" th:text="'₫' + ${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')}">₫420,000</span>
                    </div>
                    <div class="quantity-selector">
                        <button class="qty-btn minus-btn">-</button>
                        <input type="number" value="1" min="1" th:max="${product.stockQuantity}" class="qty-input">
                        <button class="qty-btn plus-btn">+</button>
                    </div>
                    <button class="add-to-cart-btn">
                        <span>THÊM VÀO GIỎ</span>
                        <i class="fas fa-shopping-bag"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>
    </main>

    <!-- Quick View Modal -->
    <div class="quick-view-modal" id="quickViewModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close-btn" id="modalCloseBtn">
                <i class="fas fa-times"></i>
            </button>
            <div class="modal-body">
                <div class="modal-product-image">
                    <img id="modalProductImage" src="" alt="Sản phẩm">
                </div>
                <div class="modal-product-info">
                    <h2 class="modal-product-name" id="modalProductName"></h2>
                    <div class="modal-price-rating-row">
                        <div class="modal-product-price-container">
                            <p class="modal-product-price" id="modalProductPrice"></p>
                        </div>
                        <div class="modal-product-rating">
                            <div class="rating-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="rating-text">(56 Reviews)</span>
                        </div>
                    </div>
                    <div class="modal-product-description">
                        <p id="modalProductDescription">Hoa tươi cao cấp được chọn lọc kỹ lưỡng từ vườn ươm uy tín. Mỗi bông hoa đều được chăm sóc cẩn thận để đảm bảo độ tươi và vẻ đẹp hoàn hảo. Thích hợp trang trí nhà cửa, văn phòng hoặc làm quà tặng ý nghĩa cho người thân yêu.</p>
                    </div>
                    <div class="modal-product-stock">
                        <span class="modal-stock-label">Tình trạng:</span>
                        <span class="modal-stock-status" id="modalStockStatus"></span>
                    </div>
                    <div class="modal-quantity-cart-row">
                        <div class="modal-quantity-section">
                            <label class="modal-quantity-label">Số lượng:</label>
                            <div class="modal-quantity-selector" id="modalQuantitySelector">
                                <button class="modal-qty-btn modal-minus-btn">-</button>
                                <input type="number" id="modalQuantity" value="1" min="1" class="modal-qty-input">
                                <button class="modal-qty-btn modal-plus-btn">+</button>
                            </div>
                        </div>
                        <button class="modal-add-to-cart-btn" id="modalAddToCartBtn">
                            <i class="fas fa-shopping-cart"></i>
                            Thêm vào giỏ hàng
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast" style="display: none;">
        <i class="fas fa-check-circle"></i>
        <span></span>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <!-- Column 1: Opening Time -->
            <div class="footer-column">
                <h4>Giờ mở cửa</h4>
                <div class="footer-opening-time">
                    <div class="opening-time-row">
                        <span class="opening-day">Thứ 2 - Thứ 6:</span>
                        <span class="opening-hours">8:00 - 22:00</span>
                    </div>
                    <div class="opening-time-row">
                        <span class="opening-day">Thứ 7:</span>
                        <span class="opening-hours">9:00 - 20:00</span>
                    </div>
                    <div class="opening-time-row">
                        <span class="opening-day">Chủ nhật:</span>
                        <span class="opening-hours">14:00 - 18:00</span>
                    </div>
                    <p class="footer-holiday">Chúng tôi làm việc cả ngày lễ</p>
                </div>
            </div>
            
            <!-- Column 2: Contact -->
            <div class="footer-column">
                <h4>Liên hệ</h4>
                <div class="footer-contact-info">
                    <p><i class="fas fa-map-marker-alt"></i> Thành phố Hồ Chí Minh, Việt Nam</p>
                    <p><i class="fas fa-phone"></i> +84 123 456 789</p>
                    <p><i class="fas fa-envelope"></i> info@fiama.com</p>
                </div>
            </div>
            
            <!-- Column 3: Central Section with Logo, Social, Apps -->
            <div class="footer-column footer-center-column">
                <div class="footer-logo-center">FIAMA</div>
                <div class="footer-social-icons">
                    <a href="#" class="social-icon" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-icon" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-icon" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                </div>
                <div class="footer-app-buttons">
                    <a href="#" class="app-button app-store">
                        <i class="fab fa-apple"></i>
                        <span>Tải từ APP STORE</span>
                    </a>
                    <a href="#" class="app-button google-play">
                        <i class="fab fa-google-play"></i>
                        <span>Tải từ GOOGLE PLAY</span>
                    </a>
                </div>
            </div>
            
            <!-- Column 4: My Account -->
            <div class="footer-column">
                <h4>Tài khoản của tôi</h4>
                <ul>
                    <li><a href="/account">Tài khoản của tôi</a></li>
                    <li><a href="/cart">Giỏ hàng</a></li>
                    <li><a href="/account#orders">Lịch sử đơn hàng</a></li>
                </ul>
            </div>
            
            <!-- Column 5: Customer Service -->
            <div class="footer-column">
                <h4>Dịch vụ khách hàng</h4>
                <ul>
                    <li><a href="#">Điều khoản sử dụng</a></li>
                    <li><a href="#">Chính sách bảo mật</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <script src="/js/cart-utils.js"></script>
    <script src="/js/product.js"></script>
</body>
</html>
